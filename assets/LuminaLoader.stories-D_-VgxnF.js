import{r as M}from"./index-CtNveh2g.js";class x{constructor(e={}){this.opts=e,this.container=null,this.progressValue=null,this.indeterminate=!1,this.progressEl=null,this.overlayEl=null,this.backdropEl=null,this.prevActiveElement=null,this.onKeydownHandler=t=>this.handleKeydown(t),this.themeMediaQuery=null,this.themeListener=null,this.currentTheme=null,typeof e.progress=="number"&&(this.progressValue=Math.max(0,Math.min(100,e.progress)),this.indeterminate=!1),this.applyTheme()}createImageElement(){const e=document.createElement("div");e.className="lumina-image-wrapper";const t=this.opts.size?`width:${this.opts.size}px;height:${this.opts.size}px;`:"";if(typeof this.opts.image=="string"){const s=document.createElement("img");s.className="lumina-image",s.src=this.opts.image,s.alt=this.opts.ariaLabel||"loading",s.setAttribute("style",`max-width:100%;max-height:100%;${t}`),e.appendChild(s)}else if(this.opts.image instanceof SVGElement){const s=this.opts.image.cloneNode(!0);s.classList.add("lumina-image"),this.opts.size&&(s.setAttribute("width",String(this.opts.size)),s.setAttribute("height",String(this.opts.size))),e.appendChild(s)}return this.opts.imageAnimation&&e.classList.add(`lumina-${this.opts.imageAnimation}`),e}renderProgress(e){const t=this.opts.progressVariant||"linear",s=document.createElement("div");if(s.className=`lumina-progress lumina-progress-${t}`,s.setAttribute("role","progressbar"),s.setAttribute("aria-valuemin","0"),s.setAttribute("aria-valuemax","100"),t==="linear"){const r=document.createElement("div");r.className="lumina-progress-track";const i=document.createElement("div");i.className="lumina-progress-bar",this.progressValue!==null?(i.style.width=`${this.progressValue}%`,i.setAttribute("aria-valuenow",String(this.progressValue))):this.indeterminate&&i.classList.add("lumina-indeterminate"),r.appendChild(i),s.appendChild(r),this.progressEl=i}else{const r=this.opts.size||80,i="http://www.w3.org/2000/svg",a=document.createElementNS(i,"svg");a.setAttribute("viewBox","0 0 100 100"),a.setAttribute("width",String(r)),a.setAttribute("height",String(r)),a.classList.add("lumina-progress-circular");const o=document.createElementNS(i,"circle");o.setAttribute("cx","50"),o.setAttribute("cy","50"),o.setAttribute("r","45"),o.setAttribute("class","lumina-progress-bg"),a.appendChild(o);const n=document.createElementNS(i,"circle");n.setAttribute("cx","50"),n.setAttribute("cy","50"),n.setAttribute("r","45"),n.setAttribute("class","lumina-progress-circle");const c=2*Math.PI*45;n.setAttribute("stroke-dasharray",String(c));const h=this.progressValue!==null?(100-this.progressValue)/100*c:c;n.setAttribute("stroke-dashoffset",String(h)),this.progressValue!==null&&n.setAttribute("aria-valuenow",String(this.progressValue)),a.appendChild(n),s.appendChild(a),this.progressEl=n}e.appendChild(s)}createOverlay(e){const t=document.createElement("div");t.className="lumina-overlay",t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.tabIndex=-1;const s=document.createElement("div");s.className="lumina-backdrop";const r=this.opts.backdrop||{},i=typeof r.opacity=="number"?r.opacity:.5,a=r.color||"black",o=r.blur?`backdrop-filter: blur(${r.blur});`:"";s.setAttribute("style",`background:${a};opacity:${i};${o}`),r.clickToClose&&s.addEventListener("click",()=>this.hide()),t.appendChild(s);const n=this.opts.overlayZIndex??1e3,c=t.getAttribute("style")||"";t.setAttribute("style",`${c};z-index:${n}`);const h=this.resolveTheme();h&&t.setAttribute("data-lumina-theme",h),(e??document.body).appendChild(t),this.overlayEl=t,this.backdropEl=s,(this.opts.theme??"auto")==="auto"&&this.watchTheme()}handleKeydown(e){if(this.overlayEl)if(e.key==="Tab"){const t=this.overlayEl.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');if(!t.length)return;const s=t[0],r=t[t.length-1];e.shiftKey&&document.activeElement===s?(e.preventDefault(),r.focus()):!e.shiftKey&&document.activeElement===r&&(e.preventDefault(),s.focus())}else e.key==="Escape"&&this.hide()}trapFocus(){if(!this.overlayEl)return;this.prevActiveElement=document.activeElement;const e=this.overlayEl.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');e.length?e[0].focus():this.overlayEl.focus(),document.addEventListener("keydown",this.onKeydownHandler),(this.opts.theme??"auto")==="auto"&&this.applyThemeToElement(this.overlayEl)}applyThemeToElement(e){if(!e)return;const t=this.resolveTheme();t?e.setAttribute("data-lumina-theme",t):e.removeAttribute("data-lumina-theme")}resolveTheme(){const e=this.opts.theme??"auto";if(e==="light"||e==="dark")return e;if(typeof window<"u"&&typeof window.matchMedia=="function")try{return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}return"light"}watchTheme(){if(!(typeof window>"u"||!("matchMedia"in window)))try{this.themeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.themeListener=t=>{this.currentTheme=t.matches?"dark":"light",this.applyThemeToElement(this.overlayEl)};const e=this.themeMediaQuery;e&&("addEventListener"in e?e.addEventListener("change",this.themeListener):"addListener"in e&&e.addListener(this.themeListener))}catch{this.themeMediaQuery=null,this.themeListener=null}}applyTheme(){const e=this.opts.theme??"auto";if(e==="light"||e==="dark"){this.currentTheme=e,this.applyThemeToElement(this.overlayEl||this.container);return}if(typeof window<"u"&&"matchMedia"in window)try{const t=window.matchMedia("(prefers-color-scheme: dark)");this.currentTheme=t.matches?"dark":"light"}catch{this.currentTheme="light"}else this.currentTheme="light";this.applyThemeToElement(this.overlayEl||this.container)}releaseFocus(){if(document.removeEventListener("keydown",this.onKeydownHandler),this.prevActiveElement instanceof HTMLElement&&this.prevActiveElement.focus(),this.prevActiveElement=null,this.themeMediaQuery&&this.themeListener){try{"removeEventListener"in this.themeMediaQuery?this.themeMediaQuery.removeEventListener("change",this.themeListener):"removeListener"in this.themeMediaQuery&&this.themeMediaQuery.removeListener(this.themeListener)}catch{}this.themeListener=null,this.themeMediaQuery=null}}mount(){if(this.container)return;const e=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body,t=document.createElement("div");if(t.className="lumina-root",t.setAttribute("aria-hidden","true"),this.opts.overlay){this.createOverlay(e);const s=document.createElement("div");if(s.className="lumina-overlay-content",this.opts.type==="image"&&this.opts.image){const r=this.createImageElement(),i=document.createElement("div");i.className="lumina-loader lumina-image",i.appendChild(r),s.appendChild(i)}else if(this.opts.type==="progress")this.renderProgress(s);else{const r=document.createElement("div");r.className=`lumina-loader lumina-${this.opts.type||"spinner"}`,r.innerHTML='<div class="lumina-spinner"></div>',s.appendChild(r)}this.overlayEl&&this.overlayEl.appendChild(s),this.container=this.overlayEl}else{if(this.opts.type==="image"&&this.opts.image){const s=this.createImageElement(),r=document.createElement("div");r.className="lumina-loader lumina-image",r.appendChild(s),t.appendChild(r)}else this.opts.type==="progress"?this.renderProgress(t):t.innerHTML=`<div class="lumina-loader lumina-${this.opts.type||"spinner"}"><div class="lumina-spinner"></div></div>`;(e??document.body).appendChild(t),this.container=t}}show(){var e;if(this.container||this.mount(),(e=this.container)==null||e.setAttribute("aria-hidden","false"),this.overlayEl){const t=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body;t instanceof HTMLElement&&t.setAttribute("aria-busy","true"),this.trapFocus()}}hide(){var e;if((e=this.container)==null||e.setAttribute("aria-hidden","true"),this.overlayEl){const t=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body;t instanceof HTMLElement&&t.removeAttribute("aria-busy"),this.releaseFocus(),this.overlayEl.remove(),this.overlayEl=null,this.backdropEl=null,this.container=null}}setProgress(e){const t=Math.max(0,Math.min(100,Math.round(e)));if(this.progressValue=t,this.indeterminate=!1,!this.container)return;const s=this.container.querySelector('[role="progressbar"]');if(s)if(s.classList.contains("lumina-progress-linear")||s.classList.contains("lumina-progress")&&s.querySelector(".lumina-progress-bar")){const r=s.querySelector(".lumina-progress-bar");r&&(r.style.width=`${t}%`,r.setAttribute("aria-valuenow",String(t)),r.classList.remove("lumina-indeterminate"))}else{const r=s.querySelector(".lumina-progress-circle");if(r){const i=Number(r.getAttribute("stroke-dasharray"))||2*Math.PI*45,a=(100-t)/100*i;r.setAttribute("stroke-dashoffset",String(a)),r.setAttribute("aria-valuenow",String(t))}}}setIndeterminate(e=!0){if(this.indeterminate=e,this.progressValue=null,!this.container)return;const t=this.container.querySelector('[role="progressbar"]');if(!t)return;const s=t.querySelector(".lumina-progress-bar");s&&(e?s.classList.add("lumina-indeterminate"):s.classList.remove("lumina-indeterminate"))}destroy(){var e;this.overlayEl&&(this.overlayEl.remove(),this.overlayEl=null,this.backdropEl=null),this.releaseFocus(),(e=this.container)==null||e.remove(),this.container=null}}function N(l){const e=new x(l);return e.mount(),e}const C=({show:l=!0,container:e,...t})=>(M.useEffect(()=>{const s=N({...t,target:e??document.body});return l&&s.show(),()=>s.destroy()},[l,e,JSON.stringify(t)]),null),z={title:"Adapters/React/LuminaLoader",component:C},u={args:{type:"spinner",show:!0}},m={args:{type:"image",image:"/logo.svg",imageAnimation:"rotate",size:80,show:!0}},d={args:{type:"progress",progressVariant:"linear",progress:45,size:200,show:!0}},p={args:{type:"spinner",overlay:!0,backdrop:{opacity:.5},show:!0}};var g,y,f;u.parameters={...u.parameters,docs:{...(g=u.parameters)==null?void 0:g.docs,source:{originalSource:`{
  args: {
    type: 'spinner',
    show: true
  }
}`,...(f=(y=u.parameters)==null?void 0:y.docs)==null?void 0:f.source}}};var v,b,E;m.parameters={...m.parameters,docs:{...(v=m.parameters)==null?void 0:v.docs,source:{originalSource:`{
  args: {
    type: 'image',
    image: '/logo.svg',
    imageAnimation: 'rotate',
    size: 80,
    show: true
  }
}`,...(E=(b=m.parameters)==null?void 0:b.docs)==null?void 0:E.source}}};var w,A,L;d.parameters={...d.parameters,docs:{...(w=d.parameters)==null?void 0:w.docs,source:{originalSource:`{
  args: {
    type: 'progress',
    progressVariant: 'linear',
    progress: 45,
    size: 200,
    show: true
  }
}`,...(L=(A=d.parameters)==null?void 0:A.docs)==null?void 0:L.source}}};var S,k,T;p.parameters={...p.parameters,docs:{...(S=p.parameters)==null?void 0:S.docs,source:{originalSource:`{
  args: {
    type: 'spinner',
    overlay: true,
    backdrop: {
      opacity: 0.5
    },
    show: true
  }
}`,...(T=(k=p.parameters)==null?void 0:k.docs)==null?void 0:T.source}}};const V=["Spinner","ImageRotate","ProgressLinear","Overlay"];export{m as ImageRotate,p as Overlay,d as ProgressLinear,u as Spinner,V as __namedExportsOrder,z as default};
