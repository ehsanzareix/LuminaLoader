class h{constructor(e={}){this.opts=e,this.container=null,this.progressValue=null,this.indeterminate=!1,this.progressEl=null,this.overlayEl=null,this.backdropEl=null,this.prevActiveElement=null,this.onKeydownHandler=i=>this.handleKeydown(i),this.themeMediaQuery=null,this.themeListener=null,this.currentTheme=null,typeof e.progress=="number"&&(this.progressValue=Math.max(0,Math.min(100,e.progress)),this.indeterminate=!1),this.applyTheme()}createDotsLoader(){const e=document.createElement("div");e.className="lumina-dots-wrapper";for(let i=0;i<3;i++){const t=document.createElement("div");t.className="lumina-dot",t.style.animationDelay=`${i*.15}s`,e.appendChild(t)}return e}createBarsLoader(){const e=document.createElement("div");e.className="lumina-bars-wrapper";for(let i=0;i<5;i++){const t=document.createElement("div");t.className="lumina-bar",t.style.animationDelay=`${i*.1}s`,e.appendChild(t)}return e}createPulseLoader(){const e=document.createElement("div");e.className="lumina-pulse-wrapper";for(let i=0;i<3;i++){const t=document.createElement("div");t.className="lumina-pulse-ring",t.style.animationDelay=`${i*.4}s`,e.appendChild(t)}return e}createGradientRingLoader(){const e=document.createElement("div");return e.className="lumina-gradient-ring",e}createOrbitLoader(){const e=document.createElement("div");e.className="lumina-orbit-wrapper";for(let i=0;i<3;i++){const t=document.createElement("div");t.className="lumina-orbit",t.style.animationDelay=`${i*.4}s`;const s=document.createElement("div");s.className="lumina-planet",t.appendChild(s),e.appendChild(t)}return e}createWaveLoader(){const e=document.createElement("div");e.className="lumina-wave-wrapper";for(let i=0;i<5;i++){const t=document.createElement("div");t.className="lumina-wave",t.style.animationDelay=`${i*.1}s`,e.appendChild(t)}return e}createImageElement(){const e=document.createElement("div");e.className="lumina-image-wrapper";const i=this.opts.size?`width:${this.opts.size}px;height:${this.opts.size}px;`:"";if(typeof this.opts.image=="string"){const t=document.createElement("img");t.className="lumina-image",t.src=this.opts.image,t.alt=this.opts.ariaLabel||"loading",t.setAttribute("style",`max-width:100%;max-height:100%;${i}`),e.appendChild(t)}else if(this.opts.image instanceof SVGElement){const t=this.opts.image.cloneNode(!0);t.classList.add("lumina-image"),this.opts.size&&(t.setAttribute("width",String(this.opts.size)),t.setAttribute("height",String(this.opts.size))),e.appendChild(t)}return this.opts.imageAnimation&&e.classList.add(`lumina-${this.opts.imageAnimation}`),e}renderProgress(e){const i=this.opts.progressVariant||"linear",t=document.createElement("div");if(t.className=`lumina-progress lumina-progress-${i}`,t.setAttribute("role","progressbar"),t.setAttribute("aria-valuemin","0"),t.setAttribute("aria-valuemax","100"),i==="linear"){const s=document.createElement("div");s.className="lumina-progress-track";const r=document.createElement("div");r.className="lumina-progress-bar",this.progressValue!==null?(r.style.width=`${this.progressValue}%`,r.setAttribute("aria-valuenow",String(this.progressValue))):this.indeterminate&&r.classList.add("lumina-indeterminate"),s.appendChild(r),t.appendChild(s),this.progressEl=r}else{const s=this.opts.size||80,r="http://www.w3.org/2000/svg",n=document.createElementNS(r,"svg");n.setAttribute("viewBox","0 0 100 100"),n.setAttribute("width",String(s)),n.setAttribute("height",String(s)),n.classList.add("lumina-progress-circular");const l=document.createElementNS(r,"circle");l.setAttribute("cx","50"),l.setAttribute("cy","50"),l.setAttribute("r","45"),l.setAttribute("class","lumina-progress-bg"),n.appendChild(l);const a=document.createElementNS(r,"circle");a.setAttribute("cx","50"),a.setAttribute("cy","50"),a.setAttribute("r","45"),a.setAttribute("class","lumina-progress-circle");const c=2*Math.PI*45;a.setAttribute("stroke-dasharray",String(c));const d=this.progressValue!==null?(100-this.progressValue)/100*c:c;a.setAttribute("stroke-dashoffset",String(d)),this.progressValue!==null&&a.setAttribute("aria-valuenow",String(this.progressValue)),n.appendChild(a),t.appendChild(n),this.progressEl=a}e.appendChild(t)}createOverlay(e){const i=document.createElement("div");i.className="lumina-overlay",i.setAttribute("role","dialog"),i.setAttribute("aria-modal","true"),i.tabIndex=-1;const t=document.createElement("div");t.className="lumina-backdrop";const s=this.opts.backdrop||{},r=typeof s.opacity=="number"?s.opacity:.5,n=s.color||"rgba(0, 0, 0, 0.8)",l=s.blur?`backdrop-filter: blur(${s.blur});-webkit-backdrop-filter: blur(${s.blur});`:"backdrop-filter: blur(8px);-webkit-backdrop-filter: blur(8px);";t.setAttribute("style",`background:${n};opacity:${r};${l}`),s.clickToClose&&t.addEventListener("click",()=>this.hide()),i.appendChild(t);const a=this.opts.overlayZIndex??1e3,c=i.getAttribute("style")||"";i.setAttribute("style",`${c};z-index:${a}`);const d=this.resolveTheme();d&&i.setAttribute("data-lumina-theme",d);let o=null;try{typeof document<"u"&&document.body&&(o=document.body)}catch{}!o&&e instanceof HTMLElement&&(o=e),!o&&this.hasAppendChild(e)&&(o=e),o&&typeof o.appendChild=="function"?o.appendChild(i):typeof document<"u"&&document.body?document.body.appendChild(i):console.warn("LuminaLoader: unable to mount overlay — no valid mount root found."),this.overlayEl=i,this.backdropEl=t,(this.opts.theme??"auto")==="auto"&&this.watchTheme()}handleKeydown(e){if(this.overlayEl)if(e.key==="Tab"){const i=this.overlayEl.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');if(!i.length)return;const t=i[0],s=i[i.length-1];e.shiftKey&&document.activeElement===t?(e.preventDefault(),s.focus()):!e.shiftKey&&document.activeElement===s&&(e.preventDefault(),t.focus())}else e.key==="Escape"&&this.hide()}trapFocus(){if(!this.overlayEl)return;this.prevActiveElement=document.activeElement;const e=this.overlayEl.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');e.length?e[0].focus():this.overlayEl.focus(),document.addEventListener("keydown",this.onKeydownHandler),(this.opts.theme??"auto")==="auto"&&this.applyThemeToElement(this.overlayEl)}applyThemeToElement(e){if(!e)return;const i=this.resolveTheme();i?e.setAttribute("data-lumina-theme",i):e.removeAttribute("data-lumina-theme")}resolveTheme(){const e=this.opts.theme??"auto";if(e==="light"||e==="dark")return e;if(typeof window<"u"&&typeof window.matchMedia=="function")try{return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch{return"light"}return"light"}addMediaQueryListener(e,i){if("addEventListener"in e)e.addEventListener("change",i);else if("addListener"in e){const t=e;t.addListener&&t.addListener&&t.addListener(i)}}removeMediaQueryListener(e,i){if("removeEventListener"in e)e.removeEventListener("change",i);else if("removeListener"in e){const t=e;t.removeListener&&t.removeListener&&t.removeListener(i)}}watchTheme(){if(!(typeof window>"u"||!("matchMedia"in window)))try{this.themeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.themeListener=i=>{this.currentTheme=i.matches?"dark":"light",this.applyThemeToElement(this.overlayEl)};const e=this.themeMediaQuery;e&&this.addMediaQueryListener(e,this.themeListener)}catch{this.themeMediaQuery=null,this.themeListener=null}}hasAppendChild(e){return typeof e=="object"&&e!==null&&"appendChild"in e&&typeof e.appendChild=="function"}applyTheme(){const e=this.opts.theme??"auto";if(e==="light"||e==="dark"){this.currentTheme=e,this.applyThemeToElement(this.overlayEl||this.container);return}if(typeof window<"u"&&"matchMedia"in window)try{const i=window.matchMedia("(prefers-color-scheme: dark)");this.currentTheme=i.matches?"dark":"light"}catch{this.currentTheme="light"}else this.currentTheme="light";this.applyThemeToElement(this.overlayEl||this.container)}releaseFocus(){if(document.removeEventListener("keydown",this.onKeydownHandler),this.prevActiveElement instanceof HTMLElement&&this.prevActiveElement.focus(),this.prevActiveElement=null,this.themeMediaQuery&&this.themeListener){try{this.removeMediaQueryListener(this.themeMediaQuery,this.themeListener)}catch{}this.themeListener=null,this.themeMediaQuery=null}}mount(){if(this.container)return;const e=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body,i=document.createElement("div");if(i.className="lumina-root",i.setAttribute("aria-hidden","true"),this.opts.overlay){this.createOverlay(e);const t=document.createElement("div");t.className="lumina-overlay-content";let s;const r=this.opts.type||"spinner";if(r==="image"&&this.opts.image?s=this.createImageElement():r==="progress"?(this.renderProgress(t),s=t.querySelector(".lumina-progress")):r==="dots"?s=this.createDotsLoader():r==="bars"?s=this.createBarsLoader():r==="pulse"?s=this.createPulseLoader():r==="gradient-ring"?s=this.createGradientRingLoader():r==="orbit"?s=this.createOrbitLoader():r==="wave"?s=this.createWaveLoader():(s=document.createElement("div"),s.className="lumina-spinner"),r!=="progress"){const n=document.createElement("div");n.className=`lumina-loader lumina-${r}`,n.appendChild(s),t.appendChild(n)}if(this.opts.text){const n=document.createElement("div");n.className="lumina-text",n.textContent=this.opts.text,t.appendChild(n)}this.overlayEl&&this.overlayEl.appendChild(t),this.container=this.overlayEl}else{const t=this.opts.type||"spinner";let s;if(t==="image"&&this.opts.image?s=this.createImageElement():t==="progress"?(this.renderProgress(i),s=i.querySelector(".lumina-progress")):t==="dots"?s=this.createDotsLoader():t==="bars"?s=this.createBarsLoader():t==="pulse"?s=this.createPulseLoader():t==="gradient-ring"?s=this.createGradientRingLoader():t==="orbit"?s=this.createOrbitLoader():t==="wave"?s=this.createWaveLoader():(s=document.createElement("div"),s.className="lumina-spinner"),t!=="progress"){const n=document.createElement("div");n.className=`lumina-loader lumina-${t}`,n.appendChild(s),i.appendChild(n)}typeof this.opts.size=="number"&&i.style.setProperty("--lumina-size",`${this.opts.size}px`),typeof this.opts.color=="string"&&i.style.setProperty("--lumina-color",this.opts.color),typeof this.opts.speed=="number"&&i.style.setProperty("--lumina-spin-speed",`${this.opts.speed}s`);let r=null;try{if(typeof this.opts.target=="string"){const n=document.querySelector(this.opts.target);n instanceof HTMLElement&&(r=n)}else this.opts.target instanceof HTMLElement&&(r=this.opts.target)}catch{}!r&&typeof document<"u"&&document.body&&(r=document.body),r&&this.hasAppendChild(r)?r.appendChild(i):typeof document<"u"&&document.body?document.body.appendChild(i):console.warn("LuminaLoader: unable to mount loader — no valid mount root found."),this.container=i}}show(){var e;if(this.container||this.mount(),(e=this.container)==null||e.setAttribute("aria-hidden","false"),this.overlayEl){const i=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body;i instanceof HTMLElement&&i.setAttribute("aria-busy","true");const t=this.overlayEl.querySelector(".lumina-overlay-content");t instanceof HTMLElement&&(typeof this.opts.size=="number"&&t.style.setProperty("--lumina-size",`${this.opts.size}px`),typeof this.opts.color=="string"&&t.style.setProperty("--lumina-color",this.opts.color),typeof this.opts.speed=="number"&&t.style.setProperty("--lumina-spin-speed",`${this.opts.speed}s`)),this.trapFocus()}}hide(){var e;if((e=this.container)==null||e.setAttribute("aria-hidden","true"),this.overlayEl){const i=typeof this.opts.target=="string"?document.querySelector(this.opts.target):this.opts.target??document.body;i instanceof HTMLElement&&i.removeAttribute("aria-busy"),this.releaseFocus(),this.overlayEl.remove(),this.overlayEl=null,this.backdropEl=null,this.container=null}}setProgress(e){const i=Math.max(0,Math.min(100,Math.round(e)));if(this.progressValue=i,this.indeterminate=!1,!this.container)return;const t=this.container.querySelector('[role="progressbar"]');if(t)if(t.classList.contains("lumina-progress-linear")||t.querySelector(".lumina-progress-bar")){const s=t.querySelector(".lumina-progress-bar");s&&(s.style.width=`${i}%`,s.setAttribute("aria-valuenow",String(i)),s.classList.remove("lumina-indeterminate"))}else{const s=t.querySelector(".lumina-progress-circle");if(s){const r=Number(s.getAttribute("stroke-dasharray"))||2*Math.PI*45,n=(100-i)/100*r;s.setAttribute("stroke-dashoffset",String(n)),s.setAttribute("aria-valuenow",String(i))}}}setIndeterminate(e=!0){if(this.indeterminate=e,this.progressValue=null,!this.container)return;const i=this.container.querySelector('[role="progressbar"]');if(!i)return;const t=i.querySelector(".lumina-progress-bar");t&&(e?t.classList.add("lumina-indeterminate"):t.classList.remove("lumina-indeterminate"))}destroy(){var e;this.overlayEl&&(this.overlayEl.remove(),this.overlayEl=null,this.backdropEl=null),this.releaseFocus(),(e=this.container)==null||e.remove(),this.container=null}}function p(u){const e=new h(u);return e.mount(),e}export{p as c};
